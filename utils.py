from websocket import create_connection

def get_mask(image, label):
    ws = create_connection("wss://xdecoder-seem.hf.space/queue/join")
    print(ws.recv())
    ws.send('{"session_hash":"rand","fn_index":0}')
    print(ws.recv())
    print(ws.recv())
    req = '{"fn_index":0,"data":[{"image":"{image}","mask":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAARMAAAC3CAYAAAAxU7r0AAAAAXNSR0IArs4c6QAACZlJREFUeF7tmVtWI0kMRM3+F82cGZhuGxuXMlNvXX5RSoobUfqAj9vt9nnjBwIQsCPwMeMrc5HpMsQuCnR+SwB3CcgXAZKgmARgKsKkVTkC5L+cZSwMgZwE/I6J36ScpNlqiUCNuMi2lFUt4UlZ3FdnqLLQ4SmDNmOp2b7PVj8j4aiEgAsBjokLZoZAoD+BlsekpSi1LEJHDSWNHgjMSdYcpa4RB+sz7qlMpup2/eAYBoEJBDgmE1xGYzCBGZ/ZDJXBUWI8BCYQ4JhMcBmNEHAgwDFxgMwICEwgwDGZ4LKFRpJjQTVFz11rd9+lEC1fIoPMDDvIiVEJgVUCJHyVGPUQgMBLAjOPyabqzWcb0fObtLEcT5wIVEtBtX2dbGQMBCCwSoBjskqM+gsCvSLVS41teGFly5fuEBhDgGMyxmqEQsCWAMfkf76Q2Esa3Pa4NXxFFBqaiqTOBPJ+snk365wHtEGgIQGOSUNTkQSBCAIcE2vqEH4gDA7rwMX1x9s49kyGQCsCHJNWdiIGAnEEOCZx7Ncmv3AK89YQUm1LQJhHYZntrnTPQMAiChY9M7AK3sEbq/e8YLyTxte0NtvWWvu87qPVPUeul9UsP8ihky0gAAFjAk+3gWNhTDy4Pf4GG1BwvDQz0rqCCCqtjA2V3Hq362QnJ2vvkt+8OkiXvzeBzANH+3NmYjABhbQptAiG0Hc83vT1FmUpCfT95PoqSxkkloJAXwIck77eogwCrgQ4Jq64Ew3D+URm9FiFSFn7CGFrwvRPQoCoJzEizxpEIo8XtTbJkRzPLTxn1crC6G2Jxbn9jRgGSwkefx4FOtwTwM4vGiscVmpJWxkC2FrGqkaLkrpGZiIFApEEOCaR9JkNgUYEeh6Tnqoaxc5WSlf7LXRp9tTsZZsQukMAAqkJcExS28NyEKhDgGNSxys2hUBqAhyT1PawHATqEOCYJPJqrhlzlSeK3/EqeV3Mu9kxdBpkJUDoTpyB3gk93ioT6BTHTlpkNs9TLONCVTUCJDncsfEWjAcQHkEW6EKAb6mLk+iAgAKBk4Nw8lZh9Z0WBVfekcmbogTm5nOu8qJRZW0IZCWgd0z0OmVlxV4QgMAbAsVPQPH1ieY8Ao0j21javJyiuAeBqh+l/d7fE+wH/Q3S61meG/QItbaK3xzAGW3SMf0EPgpKYnZnKgS2CJDoLWyXj+B6iYgCCEDgi8D7c8ExIScQ6E5A608NF9eCY9I9SOiLIeD0ZTmNETHMtItoYYogAIGcBDgmOX1hKwiUI8AxKWeZcOGKzlbc+d6O6vsLo/Vbmbt8rYFafQ75yZ6zrIwTVaUJlIp5adIsD4HmBByPiWyUrMrBlTSLOGjtPAIf79y1hWHbvXNI0QYBCDwQ4JgQCHUCnULVSYu60T8ailiJiv40Xqu2Fti5f0rSKZfqnII82npa/6Sqp8w8MSq0CVEwMwu0ZmhpDIFZBDgms/x+VIv7k91X114vTvU2VjeNhhDISIBPM6Mr7HRNoEByC6x4zXmhYpreX9CAYSEzQaV4FARePNbdIfeBYhQUQgACJwT4tk/oDX9LeIoEwMkopzFFoP+3JkgqucWueQg0+3I25Ww+07FRMlxSo7NNZJcZKiMJ287GP1u+dIfAGAIck5RWz7ZltvqUgRQthW8iTBRBAAJXBDgmV4T4fRkCWmHW6lMGnNKicFMCSRsITCfAMZmeAPRD4InA3lnYewX+9gQIRnuL1QW6ZsZ1mDqq4IbACzaA8VcEiOgVIX4PAQiICHBMRJhyFGFWDh/Y4jUB8jkhGbgscrkKpqx7Zt1LZD5FEIBAHgIckzxesAkEShPgmJS2j+XPCBD/M36Pr5PQTLKGJll6QaA6gcXPcrG8Oh32hwAErAj4HxP/iVbs2vTFkjZWhgo5ztFxg1D5DIfAbwTuk03KJTmBkoQSNYMI8Ensmg25XXK860+Ar2PJ4x+4KtKruPOSRxT/IYDXmcOAOxvuAG0DGk/yEVAOsnK7fLzYCAIQ8CHAMfHhzBQItCeQ6pikWqa99fkFkof8Ht1viF+J/MpgRoYdElnCKgsEyM6/sKCwEBlKIfCagNtn5DYIpyEAgRACw77xYXJdIwVbV9wJh10n4LoioSxWggAEvAlwKryJMy+GAEk3554Tcc6tDsxoJ+iABU/rE3idZ1Je31l1BS6hcBmijoaGbwhgKfGAAARUCHBMVDDSBAIQ4JgUyQBGFTFq8JpkdLD5SIfAGYHH88ExOaN5+FoZv3K7Q3E8H0bg43b7+LzdPofJRq4pAY6aKd7t5sa+mLY3bb5NlIcQgIAFAZPv3aTppfqYqZdrrRY0kbEq+3U9MHQ4+nRp51Z1QdX394mt9xQtV7T6eOuXzcunbmGjhVIZjUxVrcVlAs0uWgSUIqvURksVfSAAARsCbz51roAN8u+u4F3GC7JlZFkeYJ25EyA2R8yAFARIegobWGICAZePzWUI/3ubkFc0QiCMQOAdC9PMYAhAwIAAx8QAKi0lBIiehFKlGhxdcgtcS7juirORy7bPLtdM72CayQ12gUBhAhyTUPO+8eNCqAuthgdmKXB0KwsRA4HxBDgm4yMAAAjoEDg4JgdPdXYv2wVyZa1j8TcEyDXx+EFgNRKr9QDvSkCWBFlVV0b6uuCpz5SO4QSIdbgFLACBaAI6Z0CnSzQL5kNAQICwCyAdlMD3AB5P9wkQvH12WV/m9DTbVtn2yZom9hpNgM9ktP2vxBOJ2EjU5f9y87pyYmPwNB2QyQxhHUsCxN2SLr1vt1vNiNXcOjZwMIvln3z6tHhM06sbv0t6lwW6+9BNRGCGKzNUigwvUaTm19tGalNKMGVJCMgINPsujOQYtZVZRBUEIBBAgK8+AHrRv0lGkGJmIQIcEwuzrKla97dgQs/2BIhle4sRCAEfAhwTH85MgUB7AomPicJqCi3aJwCBEFAiYPa5mTVWEk4bCEBAlwDfvC5PukFgLAGOyVjrES4jEPeJxE2WkflZVW3fPZW8ggAEzAlwTMwRMwACMwhwTFZ9DiUWOnyVFPXDCLRI55aIrUfD0pFaLgaa2HOA9eCpiRSaQsCXAF+AGm9QqqGkEQRmE+CYzPYf9RBQI8AxUUNJo44E+EDkrsLqiRVI5PGhEgJ/CfDlkIayBAhvLuvww9KPUnRLLavsmpZ2rT6r8qLmPu6ZY4tVdtRvEMDqDWg8WSBAwhZgUZqcQOY0Z95NydYBEpVIGbQBvgFUWoYRIM9h6BnsToC0myIHrylemkNgDgGOyRyvUWpJgC/p9g+vFr8QZdRGywAAAABJRU5ErkJggg=="},["Text"],null,"{label}",null,null],"session_hash":"rand"}'
    req = req.replace("{image}", image).replace("{label}", label)
    print(req)
    ws.send(req)
    print(ws.recv())
    resp = ws.recv()

    return resp